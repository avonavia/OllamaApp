//Method to perform division with error checking
    private BigDecimal SafeDivide(BigDecimal a, BigDecimal b, string errorMessage)
    {
        if (b == 0)
        {
            throw new InvalidOperationException(errorMessage);
        }

        return a / b;
    }