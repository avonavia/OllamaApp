Here is a C# version of the Solidity contract method `swapTokensForExactTokens`. Please note that this is a simplified representation and may need additional error handling or adjustments depending on the specific environment you are using:

```csharp
public uint[] SwapTokensForExactTokens(uint amountOut, uint amountInMax, List<string> path, string to, uint deadline) {
    var amounts = UniswapV2Library.GetAmountsIn(Factory, amountOut, path);

    if (amounts[0] > amountInMax) throw new Exception("UniswapV2Router: EXCESSIVE_INPUT_AMOUNT");

    TransferHelper.SafeTransferFrom(path[0], msgSender, UniswapV2Library.PairFor(Factory, path[0], path[1]), amounts[0]);

    _Swap(amounts, path, to);

    return amounts;
}
```